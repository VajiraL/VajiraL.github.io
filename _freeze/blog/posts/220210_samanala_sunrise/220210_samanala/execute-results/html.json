{
  "hash": "417a37295f900f66d01169cc9251397a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Samanala Sunrise'\nsubtitle: ''\nauthor: 'Vajira'\ndescription: ''\ndate: 2022-02-10\nimage: 'viewshed_dia.png'\ncategories: ['Maps','GIS']\nlightbox: true\n---\n\n\n\n# Viewshed analysis\n\nSight of sunrise over Samanala Kanda makes for a glorious morning. On a good day there are many places in western region where you can see this.\nThere was one place on my commute to school where, if my usual bus came on time, I could see the siluette of the Sri Pada before the rising sun.\nI always tried to catch a glimpse through the crowd.\n\nIt was an interesting problem for the spatial analyst in me to map all the places that can see a Samanala Kanda sunrise.\nHereâ€™s my attempt to do that using the viewshed analysis tools in QGIS.\n\nBoth GRASS and GDAL packages in QGIS have viewshed analysis tools. There are also more feature-rich plugins like visibility analysis.\n\n## Data\n\nFor visibility analysis, we need a digital elevation model. I used the JAXA ALOS 3D DEM which is a 30 m global DEM\n## Approach\n\nViewshed analysis finds the area visible from a certain location. How can we use that to solve the problem of finding the places that can see a Sri Pada sunrise ?\nI consider a Sri Pada sunrise is conditional up on the following two requirements.\n    1. There should be a direct line-of-sight between the observer and the mountain\n    2. Relative to the observer, the sun should rise behind the mountain\n\nAreas that satisfy the first requirement can be found using viewshed analysis.\nHowever, if we did the analysis for the topmost point, results will be exaggerated because it will include any point that can see even just a tip of the mountain.\nSo it will include places from where Samanala Kanda is hidden behind other landmasses bar a tiny tip.\nSo for good measure, I run the viewshed analysis from a point on the western face of the mountain, about 200 m below the top.\n\nNow for the second requirement, we need to consider the direction of sunrise.\nDirection of sunrise changes through out the year.\nWhile it is not very apparent when you live near the equator, the sun path moves north in the north hemispheric summer and south in the winter.\nExtreme of this movement happens on the solstice, usually June 21 and December 21. So what we simply need to do is find the directions of the sunrise seen from Sri Pada for those two days.\nTriangle formed between these two lines and to the west of the mountain is the areas where such a sunrise can be seen.\n\n![](viewshed_dia.png)\n\nFinally the areas that satisfy both requirements can be found by intersecting the two results.\nHere is an embedded map of the results where you can zoom in and see where you can see a magnificent sunrise over Sri Pada. Looks like there are many good spots around Colombo to catch glorious view.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(leaflet)\nleaflet() %>%\n  addTiles() %>%  # Add default OpenStreetMap map tiles\n  addMarkers(lng=81.5, lat=6.8, popup=\"LK Random\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-42946f99fa81c446961a\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-42946f99fa81c446961a\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,null,{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org/copyright/\\\">OpenStreetMap<\\/a>,  <a href=\\\"https://opendatacommons.org/licenses/odbl/\\\">ODbL<\\/a>\"}]},{\"method\":\"addMarkers\",\"args\":[6.8,81.5,null,null,null,{\"interactive\":true,\"draggable\":false,\"keyboard\":true,\"title\":\"\",\"alt\":\"\",\"zIndexOffset\":0,\"opacity\":1,\"riseOnHover\":false,\"riseOffset\":250},\"LK Random\",null,null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]}],\"limits\":{\"lat\":[6.8,6.8],\"lng\":[81.5,81.5]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../../site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/leaflet-1.3.1/leaflet.js\"></script>\n<link href=\"../../../site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/proj4-2.6.2/proj4.min.js\"></script>\n<script src=\"../../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\n<link href=\"../../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/leaflet-binding-2.2.2/leaflet.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}